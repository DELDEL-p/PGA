<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>‡πÉ‡∏Ñ‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô‡∏ö‡πâ‡∏≤‡∏á? (Real-time)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
    <!-- Google Fonts & Cute CSS -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;700&display=swap">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css">
    <style>
        body {
            font-family: 'Prompt', sans-serif;
            background: linear-gradient(135deg, #fceabb 0%, #f8b500 100%);
            min-height: 100vh;
            margin: 0;
        }
        .container {
            background: #fffbea;
            border-radius: 20px;
            padding: 32px 16px 16px 16px;
            max-width: 440px;
            margin: 40px auto;
            box-shadow: 0 8px 32px rgba(200,160,0,0.13);
        }
        h1 {
            text-align: center;
            font-size: 2.1rem;
            margin-bottom: 18px;
            color: #bf8300;
        }
        .mud-list {
            list-style: none;
            padding: 0;
        }
        .mud-item {
            background: #fff5cc;
            border-radius: 13px;
            padding: 18px 14px 14px 14px;
            margin-bottom: 13px;
            box-shadow: 0 2px 8px rgba(220,180,0,0.07);
            display: flex;
            align-items: flex-start;
            gap: 18px;
            animation: pop-in 0.37s;
        }
        @keyframes pop-in {
            0% { transform: scale(0.95) translateY(30px); opacity: 0; }
            100% { transform: scale(1) translateY(0); opacity: 1; }
        }
        .mud-avatar {
            font-size: 2.3rem;
            background: #ffe066;
            border-radius: 50%;
            width: 54px;
            height: 54px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px #fae37477;
        }
        .mud-info {
            flex: 1;
        }
        .mud-name {
            font-weight: bold;
            color: #e6ac00;
            font-size: 1.1rem;
            margin-bottom: 3px;
        }
        .mud-place {
            color: #333;
            font-size: 1rem;
        }
        .mud-time {
            font-size: 0.88rem;
            color: #888;
            margin-top: 2px;
        }
        .mud-coord {
            font-size: 0.88rem;
            color: #b7950b;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>‡πÉ‡∏Ñ‡∏£‡∏°‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô‡∏ö‡πâ‡∏≤‡∏á? ü¶¶</h1>
    <ul class="mud-list" id="mudList">
        <li>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</li>
    </ul>
</div>
<script>
    // Firebase config (‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏°‡∏≤)
    const firebaseConfig = {
        apiKey: "AIzaSyB3hdNequpq1BUT9Bzg-HobLCTtdRDTAEA",
        authDomain: "shakemap-d69a8.firebaseapp.com",
        projectId: "shakemap-d69a8",
        storageBucket: "shakemap-d69a8.appspot.com",
        messagingSenderId: "626217349401",
        appId: "1:626217349401:web:597f8aaaac1c0bb2e49588",
        measurementId: "G-GSMPT2MS6R"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á timestamp
    function formatTS(ts) {
        if (!ts) return "";
        const d = ts.toDate ? ts.toDate() : new Date(ts);
        return d.toLocaleString('th-TH', {
            year: 'numeric', month: 'short', day: 'numeric',
            hour: '2-digit', minute: '2-digit'
        });
    }

    // Emoji ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠ (‡∏™‡∏∏‡πà‡∏°‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å)
    function getRandomEmoji() {
        const ems = ['ü¶¶','üêª','üê±','üê∂','ü¶ä','üêß','ü¶•','ü¶ù','üê∞','üê•','ü¶Ñ','üêº','ü¶â','üêª‚Äç‚ùÑÔ∏è'];
        return ems[Math.floor(Math.random() * ems.length)];
    }

    // ‡∏ü‡∏±‡∏á real-time
    db.collection("mud").orderBy("timestamp", "desc").onSnapshot(snapshot => {
        const mudList = document.getElementById('mudList');
        mudList.innerHTML = '';
        if (snapshot.empty) {
            mudList.innerHTML = '<li>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏∏‡∏î</li>';
            return;
        }
        snapshot.forEach(doc => {
            const d = doc.data();
            mudList.innerHTML += `
              <li class="mud-item">
                <div class="mud-avatar">${d.emoji||getRandomEmoji()}</div>
                <div class="mud-info">
                  <div class="mud-name">${d.name||'-'} </div>
                  <div class="mud-place">${d.place||'-'}</div>
                  <div class="mud-coord">(${d.lat?.toFixed(5)||''}, ${d.lon?.toFixed(5)||''})</div>
                  <div class="mud-time">${formatTS(d.timestamp)}</div>
                </div>
              </li>
            `;
        });
    });
</script>
</body>
</html>